function resizeBar(){$(".top-bar").innerWidth($(".top-bar").parent().innerWidth())}var phonebook=window.phonebook||function(){var a,b,c=[{first:"Adam",last:"Johnson",phone:"111-111-1111"},{first:"Vinny",last:"DeFrancesco",phone:"111-111-1111"},{first:"Corey",last:"Tucker",phone:"111-111-1111"},{first:"Emma",last:"Lydon",phone:"111-111-1111"},{first:"Kate",last:"Lowe",phone:"111-111-1111"},{first:"Jess",last:"Guerra",phone:"111-111-1111"},{first:"Zach",last:"Oliphant",phone:"111-111-1111"},{first:"Larry",last:"Oliphant",phone:"111-111-1111"},{first:"Lee",last:"DeFrancesco",phone:"111-111-1111"},{first:"Barry",last:"Lydon",phone:"111-111-1111"},{first:"Derek",last:"Jeter",phone:"111-111-1111"},{first:"Marshawn",last:"Lynch",phone:"111-111-1111"},{first:"Barack",last:"Obama",phone:"111-111-1111"},{first:"Mitt",last:"Romney",phone:"111-111-1111"},{first:"Michelle",last:"Obama",phone:"111-111-1111"},{first:"Ann",last:"Romney",phone:"111-111-1111"},{first:"Abriella",last:"Milazzo",phone:"111-111-1111"},{first:"Ryan",last:"Smith",phone:"111-111-1111"}],d=!1,e="c01",f=!1,g=function(a){a.at(b)?currentContact=b:0===b?(a.trigger("addContact"),console.log("ahh"),currentContact=0):currentContact=b-1,e=a.at(currentContact)},h={};return h.Contact=Backbone.Model.extend({first:"New",last:"Contact",phone:"Enter Number",email:"Enter Email",initialize:function(){this.on("destroy",this.onDestroy,this)},onDestroy:function(){b=this.collection.indexOf(this)}}),h.SearchView=Backbone.View.extend({el:".top-bar",template:' 		<div class="col-xs-10">            <div class="search-group has-feedback">                <i class="glyphicon glyphicon-search form-control-feedback"></i>                <input type="search" class="form-control searching" placeholder="Search..."></input>            </div>        </div>        <button class="btn btn-default" type="button">            <span class="glyphicon glyphicon-plus"></span>        </button>		',initialize:function(){this.render()},render:function(){$(this.el).html(this.template)},events:{"click button":"addContact","keyup .searching":"searchList"},addContact:function(){d||this.collection.trigger("addContact")},searchList:function(){this.collection.trigger("searched")}}),h.ContactListView=Backbone.View.extend({id:"contact-list",$container:$("#contact-list-column"),initialize:function(){this.render();this.listenTo(this.collection,"add",this.populate),this.listenTo(this.collection,"searched edited",this.populate),this.populate()},render:function(){this.$container.append(this.$el)},populate:function(){var a=this;this.collection.search($(".searching").val()).forEach(function(b){new h.ContactListingView({model:b,collection:a.collection})})}}),h.ContactListingView=Backbone.View.extend({className:"contact-listing row",$container:$("#contact-list"),template:_.template('             <div class="col-xs-10 listing-name"><p><%= name %></p></div>             <div class="delete-contact col-xs-2 glyphicon glyphicon-trash"></div>'),events:{"click .delete-contact":"listDelete","click .listing-name":"pickName"},initialize:function(){this.render(),this.listenTo(this.model,"destroy",this.removeView),this.listenTo(this.collection,"add edited searched",this.removeView),this.listenTo(this.model,"pick",this.pickName),this.model.cid==e&&this.$el.addClass("picked")},render:function(){var a=this.template({name:this.model.get("last")+", "+this.model.get("first")});this.$el.html(a),this.$container.append(this.$el)},listDelete:function(){this.model.destroy()},removeView:function(){this.remove(),this.stopListening()},pickName:function(){e=this.model.cid,$(".contact-listing").removeClass("picked"),this.$el.addClass("picked"),this.collection.trigger("pickName")}}),h.ContactViewportChildView=Backbone.View.extend({template:_.template('		<form>			<p>First Name:<input name="first" type="text" value="<%= first %>" readonly></p>			<p>Last Name:<input name="last" type="text" value="<%= last %>"" readonly></p>			<p>Phone Number:<input name="phone" type="text" value="<%= phone %>"" readonly></p>		</form>	'),events:{},initialize:function(){this.render(),this.listenTo(this.collection,"pickName",this.changeModel,this),this.listenTo(this.collection,"addContact",this.newModel,this),this.listenTo(this.collection,"edit",this.edit,this)},render:function(){var a=({first:this.model.get("first"),last:this.model.get("last"),phone:this.model.get("phone")},this.template({first:this.model.get("first"),last:this.model.get("last"),phone:this.model.get("phone")}));this.$el.html(a)},changeModel:function(){this.model=this.collection.get({cid:e}),this.render()},newModel:function(){this.model=e,this.render(),this.edit()},edit:function(){var a=$(".edit").find("span");if(d){this.$el.find("input").attr("readonly",!0).removeClass("active-edit");var b=this.$el.find("input"),c=[];b.each(function(){c.push($(this).val())}),this.model.set({first:c[0],last:c[1],phone:c[2]}),a.removeClass("glyphicon-floppy-save").addClass("glyphicon-edit"),f&&(this.collection.add(this.model),f=!1),this.render(),e=this.model.cid,this.collection.trigger("edited"),d=!1}else d=!0,this.$el.find("input").attr("readonly",!1).addClass("active-edit"),a.removeClass("glyphicon-edit").addClass("glyphicon-floppy-save")}}),h.ContactViewportView=Backbone.View.extend({model:h.Contact,className:"contact-info row",$container:$("#contact-view"),template:_.template('             <div class="col-sm-12">                <h3><%= first %> <%= last %></h3>                 <div class="contact-view-button-wrapper">                    <button class="btn btn-default edit" type="button">                        <span class="glyphicon glyphicon-edit"></span>                    </button>                    <button class="btn btn-default delete" type="button">                        <span class="glyphicon glyphicon-trash"></span>                    </button>                </div>                <div class="contact-fields">                </div>            </div>	'),events:{"click .edit":"edit","click .delete":"delete"},initialize:function(){var a=this;this.listenTo(this.collection,"pickName",this.changeModel),this.listenTo(this.collection,"addContact",this.newModel),this.listenTo(this.collection,"add change",this.subRender),this.render(),new h.ContactViewportChildView({model:a.model,collection:a.collection,el:".contact-fields"})},render:function(){var a=({first:this.model.get("first"),last:this.model.get("last")},this.template({first:this.model.get("first"),last:this.model.get("last")}));this.$el.html(a),this.$container.append(this.$el)},edit:function(){this.collection.trigger("edit")},"delete":function(){d||this.model.destroy()},newModel:function(){this.model=e,f=!0,this.subRender()},changeModel:function(){this.model=this.collection.get({cid:e}),this.subRender()},subRender:function(){var a=this.model.get("first")?this.model.get("first")+" "+this.model.get("last"):"New Contact";this.$el.find("h3").html(a)}}),h.ContactCollection=Backbone.Collection.extend({model:h.Contact,localStorage:new Backbone.LocalStorage("phonebook-store"),initialize:function(){localStorage.length?this.fetch():(this.reset(c),this.forEach(function(a){a.save()}));var b=this;e=this.at(0).cid,this.on("pickName",this.changeViewportModel,this),this.on("addContact",this.addContact,this),this.on("remove",this.findIndex,this),this.on("edited",this.sort,this),this.on("edited searched",this.pickContact,this),this.on("change",this.saveit),this.on("add",this.saveit),new h.SearchView({collection:b}),new h.ContactListView({collection:b}),a=new h.ContactViewportView({collection:b,model:this.at(0)})},saveit:function(){this.forEach(function(a){a.save()})},searchedList:this,search:function(a){if(""==a)return this;var b=new RegExp(a,"i");return this.filter(function(a){return b.test(a.get("last")+" "+a.get("first"))})},comparator:function(a){var b=a.get("last")+a.get("first");return b.toLowerCase()},addContact:function(){e=new Contact({}),$(".contact-listing").removeClass("picked")},changeViewportModel:function(){a.trigger("changeViewportModel")},findIndex:function(){g(this),this.length&&this.pickContact()},pickContact:function(){console.log(e),this.get(e).trigger("pick")}}),$(document).ready(function(){new h.ContactCollection;resizeBar(),window.onresize=resizeBar}),h}();